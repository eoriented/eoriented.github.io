<!DOCTYPE html>

<html lang="ko-KR">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no"/>

    <title>Smart Tiger&#39;s blog</title>
    
    <link rel="apple-touch-icon" sizes="180x180" href="https://eoriented.github.io/apple-touch-icon.png">
    
    
    <link rel="icon" type="image/png" sizes="16x16" href="https://eoriented.github.io/favicon.ico">
    <link rel="manifest" href="https://eoriented.github.io/manifest.json">
    <link rel="mask-icon" href="https://eoriented.github.io/safari-pinned-tab.svg" color="#FF3DB4">
    <meta name="theme-color" content="#ffffff">

    
    
    
    <link rel="stylesheet" href="https://eoriented.github.io/css/main.min.dd568c6dd83d023b8b55f4ca7cf388dc6ce3b3ae5a182c7532b74b8b9570e4ca.css"/>

    
    
    

    
    
 
    
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-160052384-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script> 
</head>
    <body>
        
<nav>
  <header>
    <div class="site-title">
        
        <a href="https://eoriented.github.io/">
        <img style="display: block; margin: 0px auto" width="90%" src="https://eoriented.github.io/images/logo2.png" /></a>
    </div>  
</header>
  <div class="nav-menu">
  
    <a class="color-link nav-link" href="https://eoriented.github.io/categories/bigdata/">Big data</a>
  
    <a class="color-link nav-link" href="https://eoriented.github.io/categories/machine-learning/">Machine learning</a>
  
    <a class="color-link nav-link" href="https://eoriented.github.io/categories/programming/">Programming</a>
  
    <a class="color-link nav-link" href="https://eoriented.github.io/categories/cloud/">Cloud</a>
  
    <a class="color-link nav-link" href="https://eoriented.github.io/categories/tools/">Tools</a>
  
    <a class="color-link nav-link" href="https://eoriented.github.io/categories/">Categories</a>
  
    <a class="color-link nav-link" href="https://eoriented.github.io/tags/">Tags</a>
  
  
</div>
<footer class="footer">
	<div class="social-icons" style="text-align: center">
    
    <a class="social-icon" href="https://github.com/eoriented" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    

    
    <a class="social-icon" href="mailto:eoriented@gmail.com" target="_blank" rel="noopener" title="Email">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M25.2794292,5.59128519 L14,16.8707144 L2.72057081,5.59128519 C3.06733103,5.30237414 3.51336915,5.12857603 4,5.12857603 L24,5.12857603 C24.4866308,5.12857603 24.932669,5.30237414 25.2794292,5.59128519 Z M25.9956978,6.99633695 C25.998551,7.04004843 26,7.08414302 26,7.12857603 L26,20.871424 C26,21.0798433 25.9681197,21.2808166 25.9089697,21.4697335 L18.7156355,14.2763993 L25.9956978,6.99633695 Z M24.9498374,22.6319215 C24.6672737,22.7846939 24.3437653,22.871424 24,22.871424 L4,22.871424 C3.5268522,22.871424 3.09207889,22.7071233 2.74962118,22.432463 L10.0950247,15.0870594 L13.9848068,18.9768415 L14.1878486,18.7737996 L14.2030419,18.7889929 L17.6549753,15.3370594 L24.9498374,22.6319215 Z M2.00810114,21.0526627 C2.00273908,20.9929669 2,20.9325153 2,20.871424 L2,7.12857603 C2,7.08414302 2.00144896,7.04004843 2.00430222,6.99633695 L9.03436454,14.0263993 L2.00810114,21.0526627 Z"></path>
        </svg>
    </a>
    

    
    <a class="social-icon" href="https://eoriented.github.io/index.xml" target="_blank" rel="noopener" type="application/rss+xml" title="Rss">
        <svg width="28px" height="28px" viewBox="0 0 8 8" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <circle xmlns="http://www.w3.org/2000/svg" class="symbol" cx="2" cy="6" r="1"/>
            <path xmlns="http://www.w3.org/2000/svg" class="symbol" d="m 1,4 a 3,3 0 0 1 3,3 h 1 a 4,4 0 0 0 -4,-4 z"/>
            <path xmlns="http://www.w3.org/2000/svg" class="symbol" d="m 1,2 a 5,5 0 0 1 5,5 h 1 a 6,6 0 0 0 -6,-6 z"/>
        </svg>
    </a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    

    
</div>




	
	

	<script src="https://eoriented.github.io/js/main.min.fa5c2b23e07b5d9bfad267a52b4b24fdb053e6fb7524993383594926a3ac270c.js" integrity="sha256-+lwrI+B7XZv60melK0sk/bBT5vt1JJkzg1lJJqOsJww="></script>
</footer>
</nav>
        <div id="content" class="content-container">
        
<h1 class="post-title">딥러닝(Deep Learning) 살펴보기 1탄</h1>
    
    <div>
        <p>
        <p>이번 포스트에서는 Deep learning에 대해 살펴볼 예정입니다. 이번 포스트는 Reference에 있는 내용을 정리한 것입니다.
Deep learning은 대세가 되었습니다. 주변에서 딥러닝이라는 이야기가 많이 들립니다. 딥러닝이란 무엇인지 알아보도록 하겠습니다.
오늘날 딥러닝을 가능하게 해준 3가지가 있습니다.</p>
<ul>
<li>빅데이터
<ul>
<li>데이터가 많은게 깡패입니다.</li>
</ul>
</li>
<li>GPU
<ul>
<li>빨리 연산하는게 장땡이죠.</li>
</ul>
</li>
<li>알고리즘
<ul>
<li>예전에 잘 안되던 것(학습)을 잘되게 많은 연구자들이 연구하였습니다.</li>
</ul>
</li>
</ul>
<p>그럼 딥러닝을 이용해서 할 수 있는 것을 한번 볼까요? 딥러닝의 가장 좋은 활용 사례라고 할 수 있는 이미지 인식을 한번 보도록 할게요. 컴퓨터에게 동물의 그림을 보고 맞출 수 있도록 하는 것이 그 예가 되겠습니다. 그럼 코드로 바로 볼까요?</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">VGG16</span>(include_top<span style="color:#666">=</span>True, weights<span style="color:#666">=</span><span style="color:#4070a0">&#39;imagenet&#39;</span>,
        input_tensor<span style="color:#666">=</span>None, input_shape<span style="color:#666">=</span>None,
        pooling<span style="color:#666">=</span>None,
        classes<span style="color:#666">=</span><span style="color:#40a070">1000</span>):
<span style="color:#60a0b0;font-style:italic"># 중략 ...</span>

<span style="color:#60a0b0;font-style:italic"># Block 1</span>
x <span style="color:#666">=</span> Conv2D(<span style="color:#40a070">64</span>, (<span style="color:#40a070">3</span>, <span style="color:#40a070">3</span>), activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>, padding<span style="color:#666">=</span><span style="color:#4070a0">&#39;same&#39;</span>, name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block1_conv1&#39;</span>)(img_input)
x <span style="color:#666">=</span> Conv2D(<span style="color:#40a070">64</span>, (<span style="color:#40a070">3</span>, <span style="color:#40a070">3</span>), activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>, padding<span style="color:#666">=</span><span style="color:#4070a0">&#39;same&#39;</span>, name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block1_conv2&#39;</span>)(x)
x <span style="color:#666">=</span> MaxPooling2D((<span style="color:#40a070">2</span>, <span style="color:#40a070">2</span>), strides<span style="color:#666">=</span>(<span style="color:#40a070">2</span>, <span style="color:#40a070">2</span>), name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block1_pool&#39;</span>)(x)

<span style="color:#60a0b0;font-style:italic"># Block 2</span>
x <span style="color:#666">=</span> Conv2D(<span style="color:#40a070">128</span>, (<span style="color:#40a070">3</span>, <span style="color:#40a070">3</span>), activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>, padding<span style="color:#666">=</span><span style="color:#4070a0">&#39;same&#39;</span>, name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block2_conv1&#39;</span>)(x)
x <span style="color:#666">=</span> Conv2D(<span style="color:#40a070">128</span>, (<span style="color:#40a070">3</span>, <span style="color:#40a070">3</span>), activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>, padding<span style="color:#666">=</span><span style="color:#4070a0">&#39;same&#39;</span>, name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block2_conv2&#39;</span>)(x)
x <span style="color:#666">=</span> MaxPooling2D((<span style="color:#40a070">2</span>, <span style="color:#40a070">2</span>), strides<span style="color:#666">=</span>(<span style="color:#40a070">2</span>, <span style="color:#40a070">2</span>), name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block2_pool&#39;</span>)(x)

<span style="color:#60a0b0;font-style:italic"># Block 3</span>
x <span style="color:#666">=</span> Conv2D(<span style="color:#40a070">256</span>, (<span style="color:#40a070">3</span>, <span style="color:#40a070">3</span>), activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>, padding<span style="color:#666">=</span><span style="color:#4070a0">&#39;same&#39;</span>, name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block3_conv1&#39;</span>)(x)
x <span style="color:#666">=</span> Conv2D(<span style="color:#40a070">256</span>, (<span style="color:#40a070">3</span>, <span style="color:#40a070">3</span>), activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>, padding<span style="color:#666">=</span><span style="color:#4070a0">&#39;same&#39;</span>, name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block3_conv2&#39;</span>)(x)
x <span style="color:#666">=</span> Conv2D(<span style="color:#40a070">256</span>, (<span style="color:#40a070">3</span>, <span style="color:#40a070">3</span>), activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>, padding<span style="color:#666">=</span><span style="color:#4070a0">&#39;same&#39;</span>, name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block3_conv3&#39;</span>)(x)
x <span style="color:#666">=</span> MaxPooling2D((<span style="color:#40a070">2</span>, <span style="color:#40a070">2</span>), strides<span style="color:#666">=</span>(<span style="color:#40a070">2</span>, <span style="color:#40a070">2</span>), name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block3_pool&#39;</span>)(x)

<span style="color:#60a0b0;font-style:italic"># Block 4</span>
x <span style="color:#666">=</span> Conv2D(<span style="color:#40a070">512</span>, (<span style="color:#40a070">3</span>, <span style="color:#40a070">3</span>), activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>, padding<span style="color:#666">=</span><span style="color:#4070a0">&#39;same&#39;</span>, name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block4_conv1&#39;</span>)(x)
x <span style="color:#666">=</span> Conv2D(<span style="color:#40a070">512</span>, (<span style="color:#40a070">3</span>, <span style="color:#40a070">3</span>), activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>, padding<span style="color:#666">=</span><span style="color:#4070a0">&#39;same&#39;</span>, name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block4_conv2&#39;</span>)(x)
x <span style="color:#666">=</span> Conv2D(<span style="color:#40a070">512</span>, (<span style="color:#40a070">3</span>, <span style="color:#40a070">3</span>), activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>, padding<span style="color:#666">=</span><span style="color:#4070a0">&#39;same&#39;</span>, name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block4_conv3&#39;</span>)(x)
x <span style="color:#666">=</span> MaxPooling2D((<span style="color:#40a070">2</span>, <span style="color:#40a070">2</span>), strides<span style="color:#666">=</span>(<span style="color:#40a070">2</span>, <span style="color:#40a070">2</span>), name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block4_pool&#39;</span>)(x)

<span style="color:#60a0b0;font-style:italic"># Block 5</span>
x <span style="color:#666">=</span> Conv2D(<span style="color:#40a070">512</span>, (<span style="color:#40a070">3</span>, <span style="color:#40a070">3</span>), activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>, padding<span style="color:#666">=</span><span style="color:#4070a0">&#39;same&#39;</span>, name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block5_conv1&#39;</span>)(x)
x <span style="color:#666">=</span> Conv2D(<span style="color:#40a070">512</span>, (<span style="color:#40a070">3</span>, <span style="color:#40a070">3</span>), activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>, padding<span style="color:#666">=</span><span style="color:#4070a0">&#39;same&#39;</span>, name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block5_conv2&#39;</span>)(x)
x <span style="color:#666">=</span> Conv2D(<span style="color:#40a070">512</span>, (<span style="color:#40a070">3</span>, <span style="color:#40a070">3</span>), activation<span style="color:#666">=</span><span style="color:#4070a0">&#39;relu&#39;</span>, padding<span style="color:#666">=</span><span style="color:#4070a0">&#39;same&#39;</span>, name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block5_conv3&#39;</span>)(x)
x <span style="color:#666">=</span> MaxPooling2D((<span style="color:#40a070">2</span>, <span style="color:#40a070">2</span>), strides<span style="color:#666">=</span>(<span style="color:#40a070">2</span>, <span style="color:#40a070">2</span>), name<span style="color:#666">=</span><span style="color:#4070a0">&#39;block5_pool&#39;</span>)(x)

<span style="color:#60a0b0;font-style:italic"># 중략...</span>

<span style="color:#60a0b0;font-style:italic"># Create model.</span>
model <span style="color:#666">=</span> Model(inputs, x, name<span style="color:#666">=</span><span style="color:#4070a0">&#39;vgg16&#39;</span>)

<span style="color:#60a0b0;font-style:italic"># load weights</span>
<span style="color:#007020;font-weight:bold">if</span> weights <span style="color:#666">==</span> <span style="color:#4070a0">&#39;imagenet&#39;</span>:
    <span style="color:#007020;font-weight:bold">if</span> include_top:
        weights_path <span style="color:#666">=</span> get_file(<span style="color:#4070a0">&#39;vgg16_weights_tf_dim_ordering_tf_kernels.h5&#39;</span>,
                                WEIGHTS_PATH,
                                cache_subdir<span style="color:#666">=</span><span style="color:#4070a0">&#39;models&#39;</span>)
    <span style="color:#007020;font-weight:bold">else</span>:
        weights_path <span style="color:#666">=</span> get_file(<span style="color:#4070a0">&#39;vgg16_weights_tf_dim_ordering_tf_kernels_notop.h5&#39;</span>,
                                WEIGHTS_PATH_NO_TOP,
                                cache_subdir<span style="color:#666">=</span><span style="color:#4070a0">&#39;models&#39;</span>)
    model<span style="color:#666">.</span>load_weights(weights_path)

<span style="color:#60a0b0;font-style:italic"># 중략 ...</span>
<span style="color:#007020;font-weight:bold">return</span> model
</code></pre></div><p>코드를 보니 쉽지 않은 것 같아 보입니다. 참고로 저는 케라스로 코드를 짜보거나 케라스의 문서를 본적도 없습니다. 그러나 앞으로 정리한 내용을 보게 되면 위의 코드가 어떻게 돌아가는지 이해하게 될겁니다.</p>
<h2 id="neural-network-복습하기">Neural Network 복습하기</h2>
<figure>
    <img src="https://eoriented.github.io/images/deep-learning-overview-1/neural-network-overview.png" width="500px"/> 
</figure>

<p>하나의 뉴런을 모델링한 것을 나타낸 그림입니다.
이러한 뉴런들이 모여서 아래와 같이 뉴럴 네트워크를 구성하게 됩니다.</p>
<figure>
    <img src="https://eoriented.github.io/images/deep-learning-overview-1/neural-network-flow.png" width="550px"/> 
</figure>

<p>위의 그림에서 하나의 컴포넌트가 뉴런을 나타내고 있는 것이죠. 아마 이 그림을 보면 위의 그림들이 이해가 될 것입니다.</p>
<figure>
    <img src="https://eoriented.github.io/images/deep-learning-overview-1/neural-network-in-detail.png" width="550px"/> 
</figure>

<p>이러한 형태로 구성된 것이 바로 뉴럴 네트워크 입니다. 인간의 뇌를 모델링해서 컴퓨터에서도 비슷하게 동작하도록 만든 것입니다.
그럼 딥 러닝은 무엇일까요? 뉴럴 네트워크의 레이어를 깊게 쌓은 형태를 DNN(Deep Neural Network)라고 합니다.</p>
<figure>
    <img src="https://eoriented.github.io/images/deep-learning-overview-1/deep-neural-network.png" width="500px"/> 
</figure>

<p>통상 이렇게 깊게 쌓은 형태의 뉴럴 네트워크를 딥러닝이라고 하고 있죠. 물론 딥러닝과 딥뉴럴넷이 같다는 것은 아닙니다.
사람의 뇌를 모델링한 것이니까 사람이 하는 것들을 할 수 있을 것이라고 생각했지만 실제론 잘 안됩니다. 다음과 같은 문제점들이 있기 때문이죠. 바로 이러한 문제점들을 해결하기 위한 노력이 딥 러닝을 연구하는데 핵심이 되는 것입니다. 어떠한 문제를 가지고 있는지 살펴보도록 하겠습니다.</p>
<h2 id="딥러닝의-문제점">딥러닝의 문제점</h2>
<p>딥러닝의 문제점은 크게 3가지 관점에서 볼 수 있습니다. 주로 모델을 얼마나 잘 학습 시킬 것인지에 관한 문제입니다. 얼마나 잘 학습 됐는지가 바로 모델의 성능의 척도가 되기 때문입니다. 3가지의 문제점을 요약하면 다음과 같습니다.</p>
<ul>
<li>Underfitting(덜하다) : &ldquo;학습이 잘 안되요&rdquo;</li>
<li>Slow(늦다) : &ldquo;학습이 오래 걸려요&rdquo;</li>
<li>Overfitting(과하다) : &ldquo;융통성이 없어요&rdquo;</li>
</ul>
<p>그럼 각각의 문제점들에 대해서 좀 더 상세히 살펴보도록 하겠습니다.</p>
<h3 id="underfitting">Underfitting</h3>
<p>Underfitting은 학습이 잘 안되는 문제를 이야기합니다. 그러면 왜 이러한 문제가 발생할까요? 문제가 발생하는 원인을 알아보려면 먼저 Neural Network의 학습 방식에 대해서 알아야 합니다. 뉴럴 넷의 학습 방법은 바로 Back propagation 알고리즘을 사용합니다. Back propagation을 번역서에서는 역전파라고 번역이 되어 있어서 어려워 보일 수가 있는데 그냥 간단하게 뒤로 전달한다는 의미입니다. 어렸을 때 운동장에 줄을 서있고 뒷사람에게 말을 전달하듯이 말이죠.</p>
<figure>
    <img src="https://eoriented.github.io/images/deep-learning-overview-1/backpropagation.png" width="350px"/> 
</figure>

<p>back propagation을 통해서 뒤로 전달하는 값은 바로 내가 틀린정도를 알려주는 것입니다. 내가 틀린 정도를 미분(기울기를 알아내서)하여 뒤로 전달하면서 올바른 방향으로 갈 수 있도록 weight 값을 조정하는 것이죠. 결국 미분하고, 곱하고, 더하고 뒤로 전달하면서 업데이트를 하는 것입니다.
그런데 여기서 한가지 문제가 있습니다. 전통적으로 뉴럴 넷의 경우 뉴런의 activation function을 sigmoid 함수를 사용하고 있었습니다. 여기서 activation function은 들어온 데이터를 다음으로 전달할 것이냐 말 것이냐를 결정하는 기준치라고 보시면 되겠습니다. sigmoid 함수는 아래와 같습니다.</p>
<figure>
    <img src="https://eoriented.github.io/images/deep-learning-overview-1/sigmoid-1.png" width="300px"/> 
</figure>

<p>그럼 왜 sigmoid 함수가 문제가 될까요? 앞서 설명했듯이 학습을 하기 위해서 내가 틀린 정도를 미분하여 뒤로 전달한다고 했습니다. 여기서 <strong>미분</strong>이 바로 문제가 됩니다.</p>
<figure>
    <img src="https://eoriented.github.io/images/deep-learning-overview-1/sigmoid-2.png" width="300px"/> 
</figure>

<p>미분을 해서 뒤로 전달을 하게 되는데 위 그림에 있는 부분에서 미분이 되는 경우 그래도 값이 뭐라도 있으므로 뒤로 값이 전달됩니다.</p>
<figure>
    <img src="https://eoriented.github.io/images/deep-learning-overview-1/sigmoid-3.png" width="300px"/> 
</figure>

<p>그러나 위의 그림처럼 해당 부분을 미분을 하면 0이나 0에 가까운데 이것을 중간에 곱해서 전달하게 되면 실제로 전달되는 값이 없게 됩니다. 그런데 이것을 학습시키기 위하여 계속 반복합니다. 그러면 input layer에 가까워질 수록 전달 받는 값이 없어서 업데이트가 없게 되는 것이죠. 이러한 현상을 바로 <strong>Vanishing Gradient</strong>라고 합니다. Vanishing Gradient 때문에 fitting이 잘 안되는 것을 바로 Underfitting이라고 하는 것입니다.</p>
<figure>
    <img src="https://eoriented.github.io/images/deep-learning-overview-1/vanishing-gradient.png" width="500px"/> 
</figure>

<p>위의 그림에서 처럼 input layer에 가까운 layer들을 전달받는 값이 사라져서 학습이 잘 안되는 문제가 발생하게 되는 것이죠.
그러면 이러한 문제는 어떻게 해결할까요? 해결 방법은 바로 input layer까지 값이 잘 전달될 수 있는 activation function을 쓰는 것입니다. 그것이 바로 그 유명한 <strong>ReLU</strong> 입니다.</p>
<h3 id="relurectified-linear-unit">ReLU(Rectified Linear Unit)</h3>
<figure>
    <img src="https://eoriented.github.io/images/deep-learning-overview-1/relu-1.png" width="300px"/> 
</figure>

<p>ReLU는 바로 위와 같은 형태입니다. 함수가 정말 간단합니다. 그럼 ReLU의 장점은 무엇일까요?</p>
<figure>
    <img src="https://eoriented.github.io/images/deep-learning-overview-1/relu-2.png" width="300px"/> 
</figure>

<p>그건 바로 sigmoid과는 다르게 미분을 하여도 값이 사라지지 않게 해서 input layer까지 error 값을 전달할 수 있게 되는 것이죠. 왜냐하면 ReLU를 보면 양의 구간에서 미분값이 전부 1이기 때문입니다.</p>
<h3 id="underfitting-결론">Underfitting 결론</h3>
<p>Underfitting은 모델이 학습이 잘 되지 않는 것이 문제였습니다. 학습을 하는 과정에서 에러를 교정하기 위한 값이 앞쪽(input layer)까지 전달되어야 하는데, 이전에 많이 사용하던 activation function인 sigmoid의 경우에 값이 전달되다가 사라지는 Vanishing Gradient가 발생하여 학습이 되지 았습니다.
그래서 Vanishing Gradient를 해결하기 위해서 미분 값이 사라지지 않는 ReLU를 이용하여 학습이 더 잘 되도록 하였습니다.</p>
<ul>
<li>문제 : Vanishing Gradient</li>
<li>해결법 : sigmoid -&gt; ReLU</li>
</ul>
<p>이번 포스트에서는 딥러닝의 개요과 뉴럴 네트워크의 개요에 대해 살펴보고, 이런 딥러닝이 가진 문제점 중에 Underfitting에 대해 살펴보고 이에 대한 해결 방법에 관해 알아보았습니다. 다음 포스트에서는 이어서 딥러닝의 학습이 느린 이유와 이를 해결할 수 있는 방법에 대해 알아보도록 하겠습니다.</p>
<h2 id="references"><strong>References</strong></h2>
<ul>
<li><a href="https://www.slideshare.net/yongho/ss-79607172">자습해도 모르겠던 딥러닝, 머리속에 인스톨 시켜드립니다</a></li>
<li><a href="https://github.com/fchollet/deep-learning-models/blob/master/vgg16.py">VGG16 with keras</a></li>
</ul>

        </p>

        <br />
        <br />

        <div class="paging post-paging" style="margin-bottom: 15px;">
            
            
            
            <div style="text-align: right">
                <a class="right" href="https://eoriented.github.io/post/deep-learning-overview-2/" rel="next" style="color: #64BEA3">
                    <span>딥러닝(Deep Learning) 살펴보기 2탄</span>&nbsp;&nbsp;<i class="fa fa-play" aria-hidden="true"></i>
                </a>
            </div>
            
            
        </div>
    </div>

    
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "smart-tiger" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

    <div class="page-footer">
        
        <hr class="footer-divider">
        
            <a class="tag" href="https://eoriented.github.io/tags/deeplearning">#deeplearning</a>
        
            <a class="tag" href="https://eoriented.github.io/tags/machinelearning">#machinelearning</a>
        
            <a class="tag" href="https://eoriented.github.io/tags/dl">#dl</a>
        
            <a class="tag" href="https://eoriented.github.io/tags/ml">#ml</a>
        
            <a class="tag" href="https://eoriented.github.io/tags/sigmoid">#sigmoid</a>
        
            <a class="tag" href="https://eoriented.github.io/tags/relu">#relu</a>
        
            <a class="tag" href="https://eoriented.github.io/tags/underfitting">#underfitting</a>
        
            <a class="tag" href="https://eoriented.github.io/tags/overfitting">#overfitting</a>
        
            <a class="tag" href="https://eoriented.github.io/tags/neuralnetworl">#neuralnetworl</a>
        
            <a class="tag" href="https://eoriented.github.io/tags/dnn">#dnn</a>
        
      
    </div>


        
        </div>
        <footer class="footer-mobile">
	<div class="social-icons" style="text-align: center">
    
    <a class="social-icon" href="https://github.com/eoriented" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    

    
    <a class="social-icon" href="mailto:eoriented@gmail.com" target="_blank" rel="noopener" title="Email">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M25.2794292,5.59128519 L14,16.8707144 L2.72057081,5.59128519 C3.06733103,5.30237414 3.51336915,5.12857603 4,5.12857603 L24,5.12857603 C24.4866308,5.12857603 24.932669,5.30237414 25.2794292,5.59128519 Z M25.9956978,6.99633695 C25.998551,7.04004843 26,7.08414302 26,7.12857603 L26,20.871424 C26,21.0798433 25.9681197,21.2808166 25.9089697,21.4697335 L18.7156355,14.2763993 L25.9956978,6.99633695 Z M24.9498374,22.6319215 C24.6672737,22.7846939 24.3437653,22.871424 24,22.871424 L4,22.871424 C3.5268522,22.871424 3.09207889,22.7071233 2.74962118,22.432463 L10.0950247,15.0870594 L13.9848068,18.9768415 L14.1878486,18.7737996 L14.2030419,18.7889929 L17.6549753,15.3370594 L24.9498374,22.6319215 Z M2.00810114,21.0526627 C2.00273908,20.9929669 2,20.9325153 2,20.871424 L2,7.12857603 C2,7.08414302 2.00144896,7.04004843 2.00430222,6.99633695 L9.03436454,14.0263993 L2.00810114,21.0526627 Z"></path>
        </svg>
    </a>
    

    
    <a class="social-icon" href="https://eoriented.github.io/index.xml" target="_blank" rel="noopener" type="application/rss+xml" title="Rss">
        <svg width="28px" height="28px" viewBox="0 0 8 8" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <circle xmlns="http://www.w3.org/2000/svg" class="symbol" cx="2" cy="6" r="1"/>
            <path xmlns="http://www.w3.org/2000/svg" class="symbol" d="m 1,4 a 3,3 0 0 1 3,3 h 1 a 4,4 0 0 0 -4,-4 z"/>
            <path xmlns="http://www.w3.org/2000/svg" class="symbol" d="m 1,2 a 5,5 0 0 1 5,5 h 1 a 6,6 0 0 0 -6,-6 z"/>
        </svg>
    </a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    

    
</div>




	
		
		
		
	

	<script src="https://eoriented.github.io/js/main.min.fa5c2b23e07b5d9bfad267a52b4b24fdb053e6fb7524993383594926a3ac270c.js" integrity="sha256-+lwrI+B7XZv60melK0sk/bBT5vt1JJkzg1lJJqOsJww="></script>
</footer>
    </body>
</html>